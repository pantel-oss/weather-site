<!DOCTYPE html>
<html lang="mk">
<head>
<meta charset="UTF-8">
<title>–í—Ä–µ–º–µ–Ω—Å–∫–∞ –ø—Ä–æ–≥–Ω–æ–∑–∞</title>
<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    overflow: hidden;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: start;
    background: linear-gradient(to bottom, #87ceeb, #fcd299);
    position: relative;
    padding-top: 50px;
  }

  /* –û–±–ª–∞–∫–∞ */
  .clouds-front, .clouds-back {
    position: absolute;
    top: 0;
    left: -50%;
    width: 200%;
    height: 100%;
    background-size: cover;
    z-index: 0;
  }
  .clouds-front {
    background: url('https://i.imgur.com/O5K95f7.png') repeat-x;
    animation: moveFront 60s linear infinite;
    opacity: 0.6;
  }
  .clouds-back {
    background: url('https://i.imgur.com/6d2khXJ.png') repeat-x;
    animation: moveBack 120s linear infinite;
    opacity: 0.4;
  }

  @keyframes moveFront { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }
  @keyframes moveBack { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }

  /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ–≥–æ–¥—ã */
  .weather-box {
    position: relative;
    z-index: 10;
    background: rgba(255,255,255,0.9);
    padding: 25px;
    border-radius: 14px;
    width: 400px;
    text-align: center;
    box-shadow: 0 10px 30px rgba(0,0,0,0.25);
  }

  h2 { margin-top: 0; }
  input { width: 100%; padding: 10px; margin-bottom: 12px; border-radius: 8px; border: 1px solid #ccc; font-size: 16px; }
  button { width: 100%; padding: 10px; border: none; border-radius: 8px; background: #ff8c00; color: white; font-size: 16px; cursor: pointer; }
  button:hover { background: #e67600; }
  .result { margin-top: 15px; font-size: 16px; }

  /* –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–æ–≥–Ω–æ–∑–∞ –Ω–µ–¥–µ–ª–∏ */
  table { width: 100%; border-collapse: collapse; margin-top: 15px; }
  th, td { padding: 8px; text-align: center; border: 1px solid #ccc; }
  th { background: #ffebcd; }
</style>
</head>
<body>

<div class="clouds-back"></div>
<div class="clouds-front"></div>

<div class="weather-box">
  <h2>‚òÅÔ∏è –í—Ä–µ–º–µ–Ω—Å–∫–∞ –ø—Ä–æ–≥–Ω–æ–∑–∞</h2>
  <input id="city" placeholder="–í–Ω–µ—Å–∏ –≥—Ä–∞–¥">
  <button onclick="getWeather()">–ü—Ä–æ–≤–µ—Ä–∏ –≤—Ä–µ–º–µ</button>
  <div class="result" id="result"></div>
  <div id="weekly" style="margin-top:15px;"></div>
</div>

<script>
async function getWeather() {
  const city = document.getElementById('city').value.trim();
  const result = document.getElementById('result');
  const weekly = document.getElementById('weekly');

  if (!city) {
    result.textContent = '–í–Ω–µ—Å–∏ –∏–º–µ –Ω–∞ –≥—Ä–∞–¥';
    weekly.innerHTML = '';
    return;
  }

  result.textContent = '–°–µ –≤—á–∏—Ç—É–≤–∞...';
  weekly.innerHTML = '';

  try {
    // –ì–µ–æ–∫–æ–¥–∏—Ä–∞—ö–µ –≥—Ä–∞–¥–∞
    const geoRes = await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(city)}&count=1&language=mk`);
    const geoData = await geoRes.json();
    if (!geoData.results) {
      result.textContent = '–ì—Ä–∞–¥–æ—Ç –Ω–µ –µ –ø—Ä–æ–Ω–∞—ò–¥–µ–Ω üòï';
      return;
    }

    const { latitude, longitude, name, country } = geoData.results[0];

    // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∏ –Ω–µ–¥–µ–ª—å–Ω–æ–π –ø–æ–≥–æ–¥—ã
    const weatherRes = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current_weather=true&daily=temperature_2m_max,temperature_2m_min,weathercode&timezone=auto`);
    const weatherData = await weatherRes.json();

    // –¢–µ–∫—É—â–∞—è –ø–æ–≥–æ–¥–∞
    const current = weatherData.current_weather;
    result.innerHTML = `
      <b>${name}, ${country}</b><br>
      üå° –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: <b>${current.temperature}¬∞C</b><br>
      üí® –í–µ—Ç–µ—Ä: <b>${current.windspeed} m/s</b>
    `;

    // –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –Ω–µ–¥–µ–ª—é
    const daily = weatherData.daily;
    let table = `<table>
      <tr><th>–î–µ–Ω</th><th>–ú–∏–Ω ¬∞C</th><th>–ú–∞–∫—Å ¬∞C</th><th>–£—Å–ª–æ–≤</th></tr>`;
    for (let i = 0; i < daily.time.length; i++) {
      const date = new Date(daily.time[i]);
      const day = date.toLocaleDateString('mk-MK', { weekday: 'short' });
      const condition = weatherCodeToEmoji(daily.weathercode[i]);
      table += `<tr>
        <td>${day}</td>
        <td>${daily.temperature_2m_min[i]}</td>
        <td>${daily.temperature_2m_max[i]}</td>
        <td>${condition}</td>
      </tr>`;
    }
    table += `</table>`;
    weekly.innerHTML = table;

  } catch (e) {
    console.error(e);
    result.textContent = '–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –≤—á–∏—Ç—É–≤–∞—ö–µ –Ω–∞ –ø–æ–¥–∞—Ç–æ—Ü–∏';
    weekly.innerHTML = '';
  }
}

// –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ weathercode –≤ emoji (–ø—Ä–æ—Å—Ç–µ–π—à–∞—è –≤–µ—Ä—Å–∏—è)
function weatherCodeToEmoji(code) {
  switch(code) {
    case 0: return '‚òÄÔ∏è'; // —è—Å–Ω–æ
    case 1: return 'üå§'; // –º–∞–ª–æ –æ–±–ª–∞—á–Ω–æ
    case 2: return '‚õÖ'; // –æ–±–ª–∞—á–Ω–æ —Å –ø—Ä–æ—è—Å–Ω–µ–Ω–∏—è–º–∏
    case 3: return '‚òÅÔ∏è'; // –æ–±–ª–∞—á–Ω–æ
    case 45: case 48: return 'üå´'; // —Ç—É–º–∞–Ω
    case 51: case 53: case 55: return 'üå¶'; // –¥–æ–∂–¥—å –º–µ–ª–∫–∏–π
    case 61: case 63: case 65: return 'üåß'; // –¥–æ–∂–¥—å
    case 71: case 73: case 75: return '‚ùÑÔ∏è'; // —Å–Ω–µ–≥
    case 95: case 96: case 99: return '‚õà'; // –≥—Ä–æ–∑–∞
    default: return '‚ùî';
  }
}
</script>

</body>
</html>
