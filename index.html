<!DOCTYPE html>
<html lang="mk">
<head>
<meta charset="UTF-8">
<title>–í—Ä–µ–º–µ–Ω—Å–∫–∞ –ø—Ä–æ–≥–Ω–æ–∑–∞</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  min-height: 100vh;
  background: linear-gradient(120deg, #ffcc33, #ff6a00, #ffcc33);
  background-size: 300% 300%;
  animation: bgMove 10s ease infinite;
}

@keyframes bgMove {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

.phone {
  position: fixed;
  top: 15px;
  right: 20px;
  font-weight: bold;
  color: white;
  font-size: 16px;
}

.weather-box {
  margin: 90px auto 30px;
  background: rgba(255,255,255,0.95);
  padding: 25px;
  border-radius: 16px;
  width: 420px;
  text-align: center;
  box-shadow: 0 10px 30px rgba(0,0,0,0.3);
}

input {
  width: 100%;
  padding: 12px;
  margin-bottom: 12px;
  border-radius: 10px;
  border: 1px solid #ccc;
  font-size: 16px;
}

button {
  width: 100%;
  padding: 12px;
  border: none;
  border-radius: 10px;
  background: #ff6a00;
  color: white;
  font-size: 17px;
  cursor: pointer;
}

button:hover {
  background: #e55d00;
}

.result {
  margin-top: 12px;
  font-size: 18px;
}

.now-table {
  width: 100%;
  margin-top: 15px;
  border-collapse: collapse;
  font-size: 18px;
}

.now-table th, .now-table td {
  border: 1px solid #ccc;
  padding: 10px;
}

.weekly-wrapper {
  width: 100%;
  padding: 20px;
}

.weekly {
  width: 100%;
  border-collapse: collapse;
  font-size: 20px;
  background: rgba(255,255,255,0.95);
  box-shadow: 0 8px 25px rgba(0,0,0,0.25);
}

.weekly th, .weekly td {
  border: 1px solid #bbb;
  padding: 14px;
  text-align: center;
}

.weekly th {
  background: #ffe0a3;
}
</style>
</head>

<body>

<div class="phone">üìû +389 29 79 22 71</div>

<div class="weather-box">
  <h2>‚òÄÔ∏è –í—Ä–µ–º–µ–Ω—Å–∫–∞ –ø—Ä–æ–≥–Ω–æ–∑–∞</h2>
  <input id="city" placeholder="–í–Ω–µ—Å–∏ –≥—Ä–∞–¥">
  <button onclick="getWeather()">–ü—Ä–æ–≤–µ—Ä–∏ –≤—Ä–µ–º–µ</button>
  <div class="result" id="result"></div>
  <div id="now"></div>
</div>

<div class="weekly-wrapper" id="weekly"></div>

<script>
async function getWeather() {
  const city = document.getElementById('city').value.trim();
  const result = document.getElementById('result');
  const nowDiv = document.getElementById('now');
  const weekly = document.getElementById('weekly');

  if (!city) {
    result.textContent = '–í–Ω–µ—Å–∏ –∏–º–µ –Ω–∞ –≥—Ä–∞–¥';
    return;
  }

  result.textContent = '–°–µ –≤—á–∏—Ç—É–≤–∞...';
  nowDiv.innerHTML = '';
  weekly.innerHTML = '';

  try {
    const geo = await fetch(
      `https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(city)}&count=1`
    );
    const geoData = await geo.json();
    if (!geoData.results) {
      result.textContent = '–ì—Ä–∞–¥–æ—Ç –Ω–µ –µ –ø—Ä–æ–Ω–∞—ò–¥–µ–Ω';
      return;
    }

    const { latitude, longitude, name, country } = geoData.results[0];

    const weather = await fetch(
      `https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current_weather=true&daily=temperature_2m_min,temperature_2m_max,weathercode&timezone=auto`
    );
    const data = await weather.json();

    result.innerHTML = `<b>${name}, ${country}</b>`;

    nowDiv.innerHTML = `
      <table class="now-table">
        <tr>
          <th>–°–µ–≥–∞</th>
          <th>–ú–∏–Ω–∏–º—É–º</th>
          <th>–ú–∞–∫—Å–∏–º—É–º</th>
        </tr>
        <tr>
          <td>${data.current_weather.temperature}¬∞C</td>
          <td>${data.daily.temperature_2m_min[0]}¬∞C</td>
          <td>${data.daily.temperature_2m_max[0]}¬∞C</td>
        </tr>
      </table>
    `;

    let table = `<table class="weekly">
      <tr>
        <th>–î–µ–Ω</th>
        <th>–ú–∏–Ω ¬∞C</th>
        <th>–ú–∞–∫—Å ¬∞C</th>
        <th>–í—Ä–µ–º–µ</th>
      </tr>`;

    for (let i = 0; i < 7; i++) {
      const d = new Date(data.daily.time[i]);
      table += `
        <tr>
          <td>${d.toLocaleDateString('mk-MK', { weekday: 'long' })}</td>
          <td>${data.daily.temperature_2m_min[i]}</td>
          <td>${data.daily.temperature_2m_max[i]}</td>
          <td>${icon(data.daily.weathercode[i])}</td>
        </tr>`;
    }

    table += '</table>';
    weekly.innerHTML = table;

  } catch {
    result.textContent = '–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –≤—á–∏—Ç—É–≤–∞—ö–µ';
  }
}

function icon(code) {
  if (code === 0) return '‚òÄÔ∏è';
  if (code <= 2) return '‚õÖ';
  if (code <= 3) return '‚òÅÔ∏è';
  if (code < 70) return 'üåß';
  if (code < 80) return '‚ùÑÔ∏è';
  return '‚õà';
}
</script>

</body>
</html>
